<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>Rob OS</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="RM - 01 ç›‘æ§é¢æ¿">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #59d5f6 0%, #c386f4 50%, #ff9fc1 100%);
            min-height: 100vh;
            color: #333;
        }
        

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 160px; /* å‡å°‘åŸºç¡€é—´è·ï¼Œå› ä¸ºmain-panelçš„ä¸Šè¾¹è·å·²ç»å¢åŠ  */
        }

        .fixed-header {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 1160px; /* ä¸containerå†…å®¹å®½åº¦ä¸€è‡´ï¼š1200px - 40px (å·¦å³padding) */
            width: calc(100% - 40px); /* ä¸containerä¿æŒç›¸åŒçš„è¾¹è· */
        }

        .fixed-header-content {
            margin: 0;
            padding: 0;
            position: relative;
        }

        /* è¯­è¨€åˆ‡æ¢æŒ‰é’®æ ·å¼ */
        .language-switcher {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 4px 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.7rem;
            color: white;
            font-weight: 500;
            z-index: 10;
        }

        .language-switcher:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        .language-switcher .lang-icon {
            font-size: 0.8rem;
        }

        .language-switcher .lang-text {
            transition: color 0.3s ease;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            transition: color 0.3s ease;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            transition: color 0.3s ease, text-shadow 0.3s ease;
        }

        .dashboard-title-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 12px;
        }

        .dashboard-logo {
            height: 1.1rem; /* ç¼©å°åˆ°åŸæ¥çš„50%ï¼š2.2rem * 0.5 = 1.1rem */
            width: auto;
            object-fit: contain;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }

        .header p {
            font-size: 1rem;
            opacity: 0.9;
            margin: 0;
            transition: color 0.3s ease;
        }

        .connection-status {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
            color: white;
            text-align: center;
            margin: 0 auto;
            max-width: 100%; /* ä¸system-headerä¿æŒç›¸åŒå®½åº¦ */
            transition: color 0.3s ease;
        }

        .main-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px;
            margin: 100px 0 20px 0; /* è°ƒæ•´ä¸Šè¾¹è·åˆ°100pxï¼Œä¸Dashboardé¡¶éƒ¨å¯¹é½åä¿æŒç›¸åŒé—´éš™ */
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-connected { background-color: #4CAF50; }
        .status-connecting { background-color: #FF9800; }
        .status-disconnected { background-color: #f44336; }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.18);
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            text-align: left;
        }

        .card-icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #323232;
            text-align: left;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px 0;
            text-align: left !important;
        }

        .metric-label {
            font-weight: 500;
            color: #555;
            text-align: left !important;
            margin-left: 0px;
        }

        .metric-value {
            font-weight: 600;
            color: #323232;
            text-align: left !important;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px 0;
            position: relative;
            box-sizing: border-box;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 10px;
            transition: width 0.3s ease;
            text-align: center;
            line-height: 20px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            position: relative;
            box-sizing: border-box;
            max-width: 100%;
        }

        .cpu-cores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }

        .cpu-core {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 8px;
            text-align: left;
            border: 1px solid #e9ecef;
        }

        .cpu-core-id {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 2px;
            text-align: left;
        }

        .cpu-core-usage {
            font-weight: bold;
            color: #323232;
            text-align: left;
        }

        .cpu-core-freq {
            font-size: 0.7rem;
            color: #888;
            text-align: left;
        }

        /* æ¨ç†æœåŠ¡å™¨ CPU æŸ±çŠ¶å›¾æ ·å¼ */
        .cpu-chart {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .cpu-bar-item {
            display: flex;
            align-items: center;
            gap: 8px;
            height: 28px;
        }

        .cpu-bar-label {
            width: 50px;
            font-size: 0.8rem;
            font-weight: 500;
            color: #666;
            text-align: left;
            flex-shrink: 0;
        }

        .cpu-bar-container {
            flex: 1;
            height: 18px;
            background-color: #e0e0e0;
            border-radius: 9px;
            overflow: hidden;
            position: relative;
        }

        .cpu-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 9px;
            transition: width 0.3s ease;
            position: relative;
            min-width: 0; /* ç§»é™¤æœ€å°å®½åº¦é™åˆ¶ */
        }

        .cpu-bar-value {
            font-size: 0.6rem; /* ç¼©å°å­—ä½“ */
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            position: absolute;
            right: 4px; /* å‡å°å³è¾¹è· */
            top: 50%;
            transform: translateY(-50%);
            z-index: 2;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
            min-width: max-content; /* ç¡®ä¿æ–‡å­—å®Œæ•´æ˜¾ç¤º */
        }

        /* å†…å­˜ã€æ˜¾å­˜ã€GPUç›‘æ§ä¸“ç”¨æ ·å¼ */
        .memory-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .memory-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .memory-metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .memory-metric-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
            margin: 0 !important;
        }

        .memory-metric-value {
            font-size: 0.85rem;
            font-weight: bold;
            color: #323232;
        }

        /* æ¨ç†æœåŠ¡å™¨ æ¸©åº¦ç›‘æ§æŸ±çŠ¶å›¾æ ·å¼ */
        .temp-chart {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .temp-bar-item {
            display: flex;
            align-items: center;
            gap: 10px;
            height: 30px;
        }

        .temp-bar-label {
            width: 70px;
            font-size: 0.85rem;
            font-weight: 500;
            color: #666;
            text-align: left;
            flex-shrink: 0;
        }

        .temp-bar-container {
            flex: 1;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .temp-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease, background 0.3s ease;
            position: relative;
            min-width: 45px; /* ç¡®ä¿å³ä½¿æ˜¯ä½æ¸©åº¦ä¹Ÿæœ‰æœ€å°å®½åº¦æ¥æ˜¾ç¤ºæ–‡å­— */
        }

        .temp-bar-value {
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 2;
        }


        .temperature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .lpmu-temperature-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 10px;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .disk-grid {
            display: grid;
            grid-template-columns: repeat(6, 200px);
            gap: 10px;
            margin-top: 10px;
            justify-content: start;
            width: 100%;
            box-sizing: border-box;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .disk-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            text-align: left;
            border: 1px solid #e9ecef;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .disk-label {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
            text-align: left;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .disk-usage {
            font-size: 1.1rem;
            font-weight: bold;
            color: #323232;
            margin-bottom: 4px;
            text-align: left;
        }

        .disk-details {
            font-size: 0.75rem;
            color: #888;
            text-align: left;
        }

        .temp-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            text-align: left;
            border: 1px solid #e9ecef;
            width: 100%;
            box-sizing: border-box;
            overflow: hidden;
        }

        .temp-label {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 5px;
            text-align: left;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .temp-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #323232;
            text-align: left;
        }

        .no-data {
            text-align: left;
            color: #888;
            font-style: italic;
            padding: 20px;
        }

        .system-section {
            margin-bottom: 20px;
        }

        .system-section:last-child {
            margin-bottom: 0;
        }

        .system-header {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .system-header h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .system-header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .lpmu-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .lpmu-row-1 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            grid-column: 1 / -1;
        }

        .lpmu-row-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            grid-column: 1 / -1;
        }

        .lpmu-full-width {
            grid-column: 1 / -1;
        }

        @media (max-width: 1200px) {
            .lpmu-temperature-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .disk-grid {
                grid-template-columns: repeat(4, 200px);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
                padding-top: 180px; /* ç§»åŠ¨ç«¯ç›¸åº”è°ƒæ•´ */
            }
            
            .fixed-header {
                top: 0;
                max-width: calc(100% - 20px); /* ä¸ç§»åŠ¨ç«¯containerä¿æŒä¸€è‡´ */
                width: calc(100% - 20px);
                padding: 20px;
            }
            
            .fixed-header-content {
                padding: 0;
            }
            
            /* ç§»åŠ¨ç«¯è¯­è¨€åˆ‡æ¢æŒ‰é’®è¿›ä¸€æ­¥ç¼©å° */
            .language-switcher {
                padding: 3px 6px;
                font-size: 0.65rem;
                gap: 3px;
                border-radius: 4px;
            }
            
            .language-switcher .lang-icon {
                font-size: 0.7rem;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .dashboard-title-container {
                margin-bottom: 8px; /* ç§»åŠ¨ç«¯å‡å°‘é—´è· */
            }
            
            .dashboard-logo {
                height: 0.9rem; /* ç¼©å°åˆ°åŸæ¥çš„50%ï¼š1.8rem * 0.5 = 0.9rem */
            }
            
            .header p {
                font-size: 0.9rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }

            /* ç§»åŠ¨ç«¯å‡å°‘é—´è· */
            .main-panel {
                margin: 40px 0 20px 0; /* ç§»åŠ¨ç«¯å‡å°‘ä¸Šè¾¹è·ä»100pxåˆ°40px */
                padding: 15px; /* ç§»åŠ¨ç«¯å‡å°‘å†…è¾¹è· */
            }

            .system-section {
                margin-bottom: 15px; /* ç§»åŠ¨ç«¯å‡å°‘ç³»ç»ŸåŒºå—é—´è·ï¼Œä¿æŒä¸€è‡´ */
            }

            .lpmu-dashboard,
            .lpmu-row-1,
            .lpmu-row-2 {
                grid-template-columns: 1fr;
            }

            .temperature-grid {
                grid-template-columns: 1fr;
            }

            .lpmu-temperature-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .disk-grid {
                grid-template-columns: repeat(2, 200px);
            }

            .system-header h2 {
                font-size: 1.3rem;
            }
            
            /* ç§»åŠ¨ç«¯ CPU å›¾è¡¨å•åˆ—æ˜¾ç¤º */
            .cpu-chart {
                grid-template-columns: 1fr;
            }
        }

        /* ç›‘æ§å¡ç‰‡å†…å®¹å¯¹é½æ ·å¼ */
        .system-metric-label {
            margin-left: 0px !important;
        }

        /* æŠ˜å åŠŸèƒ½æ ·å¼ */
        .collapsible-header {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 40px !important;
        }

        .collapse-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .collapse-icon.collapsed {
            transform: translateY(-50%) rotate(-90deg);
        }

        .collapsible-content {
            max-height: 5000px;
            overflow: hidden;
            transition: max-height 0.5s ease, opacity 0.3s ease;
            opacity: 1;
        }

        .collapsible-content.collapsed {
            max-height: 0;
            opacity: 0;
        }

        /* æ¨¡å‹çŠ¶æ€ç›‘æ§æ ·å¼ */
        .model-status-progress {
            position: relative;
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .model-status-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        /* è¿›åº¦æ¡å…‰çº¿æ»šåŠ¨åŠ¨ç”» */
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }

        .model-status-progress-fill.loading {
            background: linear-gradient(
                90deg,
                #4CAF50 0%,
                #81C784 50%,
                #4CAF50 100%
            );
            background-size: 1000px 100%;
            animation: shimmer 2s infinite linear;
        }

        .model-status-text {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 0.85rem;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            white-space: nowrap;
            z-index: 10;
            min-width: 40px;
            text-align: right;
        }
        
        /* å½“è¿›åº¦æ¡å®½åº¦å¾ˆå°æ—¶ï¼Œæ–‡å­—æ˜¾ç¤ºåœ¨è¿›åº¦æ¡å¤–éƒ¨ */
        .model-status-progress-fill[style*="width: 0%"] .model-status-text,
        .model-status-progress-fill[style*="width: 1"] .model-status-text {
            color: #666;
            text-shadow: none;
        }

        .model-log-window {
            background: #f8f9fa;
            color: #333;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            padding: 15px;
            border-radius: 8px;
            max-height: 0;
            overflow-y: auto;
            transition: max-height 0.3s ease;
            margin-top: 10px;
            line-height: 1.4;
            border: 1px solid #e9ecef;
        }

        .model-log-window.expanded {
            max-height: 400px; /* æ¸©åº¦ç›‘æ§é«˜åº¦çš„2å€ */
        }

        .model-log-window::-webkit-scrollbar {
            width: 8px;
        }

        .model-log-window::-webkit-scrollbar-track {
            background: #e9ecef;
            border-radius: 4px;
        }

        .model-log-window::-webkit-scrollbar-thumb {
            background: #bbb;
            border-radius: 4px;
        }

        .model-log-window::-webkit-scrollbar-thumb:hover {
            background: #999;
        }

        .model-log-line {
            padding: 2px 0;
            word-wrap: break-word;
        }

        .model-log-timestamp {
            color: #666;
        }

        .model-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 10px 10px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            margin: 10px 0;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        .model-section-header:hover {
            background: rgba(255,255,255,0.1);
        }

        .model-section-title {
            font-weight: 500;
            font-size: 1rem;
            color: #555;
        }

        /* è¦†ç›–æ¨¡å‹æ—¥å¿—æŠ˜å å›¾æ ‡çš„å®šä½ï¼Œä½¿å…¶åœ¨flexå¸ƒå±€ä¸­æ­£å¸¸å·¥ä½œ */
        .model-section-header .collapse-icon {
            position: static;
            transform: none;
            transition: transform 0.3s ease;
            color: #4CAF50;
        }

        .model-section-header .collapse-icon.collapsed {
            transform: rotate(-90deg);
        }

        /* ç‰ˆæƒä¿¡æ¯æ ·å¼ */
        .copyright {
            text-align: center;
            padding: 30px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 40px;
        }

        .copyright p {
            margin: 0;
            line-height: 1.5;
        }

        .copyright .separator {
            margin: 0 8px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <!-- å›ºå®šå¤´éƒ¨ -->
    <div class="fixed-header">
        <div class="fixed-header-content">
            <!-- è¯­è¨€åˆ‡æ¢æŒ‰é’® -->
            <div class="language-switcher" id="languageSwitcher" onclick="switchLanguage()">
                <span class="lang-icon">ğŸŒ</span>
                <span class="lang-text" id="langText">EN</span>
            </div>
            
            <div class="header">
                <div class="dashboard-title-container">
                    <img src="base.png" alt="Logo" class="dashboard-logo" />
                </div>
                <h1 data-translate="title">RM - 01 Dashboard</h1>
                <p data-translate="subtitle">RobOS ( Rack on board ) å®æ—¶ç³»ç»Ÿæ€§èƒ½ç›‘æ§é¢æ¿</p>
            </div>

            <div class="connection-status">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                    <div>
                        <span class="status-indicator status-connecting" id="agxStatusIndicator"></span>
                        <span id="agxStatusText" data-translate="connecting-inference">æ­£åœ¨è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨...</span>
                    </div>
                    <div>
                        <span class="status-indicator status-connecting" id="lpmuStatusIndicator"></span>
                        <span id="lpmuStatusText" data-translate="connecting-application">æ­£åœ¨è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="main-panel">

            <!-- æ¨¡å‹çŠ¶æ€ç›‘æ§éƒ¨åˆ† -->
            <div class="system-section">
                <div class="system-header collapsible-header" onclick="toggleSection('model-section')">
                    <div>
                        <h2 data-translate="model-monitoring">æ¨¡å‹çŠ¶æ€ç›‘æ§</h2>
                        <p data-translate="model-status-desc">æ¨¡å‹åŠ è½½è¿›åº¦å’Œè¿è¡Œæ—¥å¿—ç›‘æ§</p>
                    </div>
                    <span class="collapse-icon" id="model-section-icon">â–¼</span>
                </div>
            
                <div class="collapsible-content" id="model-section">
                    <div class="dashboard">
                        <!-- æ¨¡å‹æ‹‰èµ·çŠ¶æ€ -->
                        <div class="card" style="grid-column: 1 / -1;">
                            <div class="card-header">
                                <div class="card-icon"> </div>
                                <div class="card-title" data-translate="model-loading-status">æ¨¡å‹æ‹‰èµ·çŠ¶æ€</div>
                            </div>
                            <div id="modelLoadingContent">
                                <!-- ä¸»æ¨¡å‹ -->
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                        <span style="font-weight: 500; color: #555;" data-translate="main-model">ä¸»æ¨¡å‹</span>
                                    </div>
                                    <div class="model-status-progress">
                                        <div class="model-status-progress-fill" id="llm-progress" style="width: 0%;">
                                            <span class="model-status-text" id="llm-status-text">--</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- åµŒå…¥æ¨¡å‹ -->
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                        <span style="font-weight: 500; color: #555;" data-translate="embedding-model">åµŒå…¥æ¨¡å‹</span>
                                    </div>
                                    <div class="model-status-progress">
                                        <div class="model-status-progress-fill" id="embedding-progress" style="width: 0%;">
                                            <span class="model-status-text" id="embedding-status-text">--</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- é‡æ’æ¨¡å‹ -->
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                        <span style="font-weight: 500; color: #555;" data-translate="reranker-model">é‡æ’æ¨¡å‹</span>
                                    </div>
                                    <div class="model-status-progress">
                                        <div class="model-status-progress-fill" id="reranker-progress" style="width: 0%;">
                                            <span class="model-status-text" id="reranker-status-text">--</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- æ¨¡å‹è¿è¡Œæ—¥å¿— -->
                        <div class="card" style="grid-column: 1 / -1;">
                            <div class="card-header">
                                <div class="card-icon"> </div>
                                <div class="card-title" data-translate="model-runtime-logs">æ¨¡å‹è¿è¡Œæ—¥å¿—</div>
                            </div>
                            <div id="modelLogsContent">
                                <!-- ä¸»æ¨¡å‹æ—¥å¿— -->
                                <div class="model-section-header" onclick="toggleModelLog('llm')">
                                    <span class="model-section-title" data-translate="main-model">ä¸»æ¨¡å‹</span>
                                    <span class="collapse-icon collapsed" id="llm-log-icon">â–¼</span>
                                </div>
                                <div class="model-log-window" id="llm-log-window"></div>

                                <!-- åµŒå…¥æ¨¡å‹æ—¥å¿— -->
                                <div class="model-section-header" onclick="toggleModelLog('embedding')">
                                    <span class="model-section-title" data-translate="embedding-model">åµŒå…¥æ¨¡å‹</span>
                                    <span class="collapse-icon collapsed" id="embedding-log-icon">â–¼</span>
                                </div>
                                <div class="model-log-window" id="embedding-log-window"></div>

                                <!-- é‡æ’æ¨¡å‹æ—¥å¿— -->
                                <div class="model-section-header" onclick="toggleModelLog('reranker')">
                                    <span class="model-section-title" data-translate="reranker-model">é‡æ’æ¨¡å‹</span>
                                    <span class="collapse-icon collapsed" id="reranker-log-icon">â–¼</span>
                                </div>
                                <div class="model-log-window" id="reranker-log-window"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ¨ç†æœåŠ¡å™¨ ç›‘æ§éƒ¨åˆ† -->
            <div class="system-section">
                <div class="system-header collapsible-header" onclick="toggleSection('inference-section')">
                    <div>
                        <h2 data-translate="inference-monitoring">æ¨ç†æ¨¡ç»„ç›‘æ§</h2>
                        <p data-translate="nvidia-status">NVIDIA æ¨ç†æœåŠ¡å™¨ç³»ç»ŸçŠ¶æ€</p>
                    </div>
                    <span class="collapse-icon" id="inference-section-icon">â–¼</span>
                </div>
                
                <div class="collapsible-content" id="inference-section">
                <div class="dashboard">
                    <!-- æ¨ç†æœåŠ¡å™¨ CPU ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="cpu-monitoring">CPU ç›‘æ§</div>
                        </div>
                        <div id="cpuContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- æ¨ç†æœåŠ¡å™¨ å†…å­˜ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="memory-monitoring">æ˜¾å­˜ç›‘æ§</div>
                        </div>
                        <div id="memoryContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- æ¨ç†æœåŠ¡å™¨ æ¸©åº¦ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="temperature-monitoring">æ¸©åº¦ç›‘æ§</div>
                        </div>
                        <div id="temperatureContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- æ¨ç†æœåŠ¡å™¨ åŠŸè€—ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="power-monitoring">åŠŸè€—ç›‘æ§</div>
                        </div>
                        <div id="powerContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- æ¨ç†æœåŠ¡å™¨ GPU ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="gpu-monitoring">GPU ç›‘æ§</div>
                        </div>
                        <div id="gpuContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- æ¨ç†æœåŠ¡å™¨ ç³»ç»Ÿä¿¡æ¯å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="system-info">ç³»ç»Ÿä¿¡æ¯</div>
                        </div>
                        <div id="systemContent">
                            <div class="memory-chart">
                                <div class="memory-metric">
                                    <span class="memory-metric-label" data-translate="last-update">æœ€åæ›´æ–°</span>
                                    <span class="memory-metric-value" id="lastUpdate">-</span>
                                </div>
                                <div class="memory-metric">
                                    <span class="memory-metric-label" data-translate="connection-time">è¿æ¥æ—¶é—´</span>
                                    <span class="memory-metric-value" id="connectionTime">-</span>
                                </div>
                                <div class="memory-metric">
                                    <span class="memory-metric-label" data-translate="data-packets">æ•°æ®åŒ…</span>
                                    <span class="memory-metric-value" id="dataPackets">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>

            <!-- LattePanda Mu ç›‘æ§éƒ¨åˆ† -->
            <div class="system-section">
                <div class="system-header collapsible-header" onclick="toggleSection('application-section')">
                    <div>
                        <h2 data-translate="application-monitoring">åº”ç”¨æ¨¡ç»„ç›‘æ§</h2>
                        <p data-translate="intel-status">Intel X86 åº”ç”¨æœåŠ¡å™¨ç³»ç»ŸçŠ¶æ€</p>
                    </div>
                    <span class="collapse-icon" id="application-section-icon">â–¼</span>
                </div>
            
            <div class="collapsible-content" id="application-section">
            <div class="lpmu-dashboard">
                <!-- ç¬¬ä¸€è¡Œï¼šCPUã€å†…å­˜ã€ç³»ç»Ÿä¿¡æ¯ -->
                <div class="lpmu-row-1">
                    <!-- åº”ç”¨æœåŠ¡å™¨ CPU ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="cpu-monitoring">CPU ç›‘æ§</div>
                        </div>
                        <div id="lpmuCpuContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- åº”ç”¨æœåŠ¡å™¨ å†…å­˜ç›‘æ§å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="ram-monitoring">å†…å­˜ç›‘æ§</div>
                        </div>
                        <div id="lpmuMemoryContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>

                    <!-- åº”ç”¨æœåŠ¡å™¨ ç³»ç»Ÿä¿¡æ¯å¡ç‰‡ -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="system-info">ç³»ç»Ÿä¿¡æ¯</div>
                        </div>
                        <div id="lpmuSystemContent">
                            <div class="memory-chart">
                                <div class="memory-metric">
                                    <span class="memory-metric-label" data-translate="last-update">æœ€åæ›´æ–°</span>
                                    <span class="memory-metric-value" id="lpmuLastUpdate">-</span>
                                </div>
                                <div class="memory-metric">
                                    <span class="memory-metric-label" data-translate="connection-time">è¿æ¥æ—¶é—´</span>
                                    <span class="memory-metric-value" id="lpmuConnectionTime">-</span>
                                </div>
                                <div class="memory-metric">
                                    <span class="memory-metric-label" data-translate="data-packets">æ•°æ®åŒ…</span>
                                    <span class="memory-metric-value" id="lpmuDataPackets">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬äºŒè¡Œï¼šæ¸©åº¦ç›‘æ§ -->
                <div class="lpmu-row-2">
                    <!-- åº”ç”¨æœåŠ¡å™¨ æ¸©åº¦ç›‘æ§å¡ç‰‡ -->
                    <div class="card lpmu-full-width">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="temperature-monitoring">æ¸©åº¦ç›‘æ§</div>
                        </div>
                        <div id="lpmuTemperatureContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬ä¸‰è¡Œï¼šç£ç›˜ç›‘æ§ -->
                <div class="lpmu-row-2">
                    <!-- åº”ç”¨æœåŠ¡å™¨ ç£ç›˜ç›‘æ§å¡ç‰‡ -->
                    <div class="card lpmu-full-width">
                        <div class="card-header">
                            <div class="card-icon"> </div>
                            <div class="card-title" data-translate="disk-monitoring">ç£ç›˜ç›‘æ§</div>
                        </div>
                        <div id="lpmuDiskContent">
                            <div class="no-data" data-translate="waiting-data">ç­‰å¾…æ•°æ®...</div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>

        </div>
    </div>

    <!-- ç‰ˆæƒä¿¡æ¯ -->
    <div class="copyright">
        <p>Â© 2026 RobOS Team<span class="separator">|</span>RMinte (Chengdu) Artificial Intelligence Technology Co., Ltd.<span class="separator">|</span>www.RMinte.com</p>
    </div>

    <script>
        // WebSocket è¿æ¥ç®¡ç†
        class æ¨ç†æœåŠ¡å™¨Monitor {
            constructor() {
                this.ws = null;
                this.reconnectInterval = 3000;
                this.maxReconnectAttempts = 5;
                this.reconnectAttempts = 0;
                this.connectionStartTime = null;
                this.dataPacketCount = 0;
                this.isConnecting = false;
                
                this.init();
            }

            init() {
                this.connect();
                this.startConnectionTimeUpdate();
            }

            connect() {
                if (this.isConnecting) return;
                
                this.isConnecting = true;
                const connectingText = getTranslation('connecting-inference', 'æ­£åœ¨è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨...');
                this.updateConnectionStatus('connecting', connectingText);

                try {
                    // è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨ æœåŠ¡å™¨çš„ WebSocket
                    this.ws = new WebSocket('ws://10.10.99.98:58090/socket.io/?EIO=4&transport=websocket');
                    
                    this.ws.onopen = () => {
                        console.log('WebSocket è¿æ¥å·²å»ºç«‹');
                        this.isConnecting = false;
                        this.reconnectAttempts = 0;
                        this.connectionStartTime = new Date();
                        const connectedText = getTranslation('connected-inference', 'å·²è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨');
                        this.updateConnectionStatus('connected', connectedText);
                        
                        // å‘é€åˆå§‹è¿æ¥æ¶ˆæ¯ (Socket.IO æ¡æ‰‹)
                        this.ws.send('40');
                    };

                    this.ws.onmessage = (event) => {
                        this.handleMessage(event.data);
                    };

                    this.ws.onclose = (event) => {
                        console.log('WebSocket è¿æ¥å·²å…³é—­:', event.code, event.reason);
                        this.isConnecting = false;
                        this.connectionStartTime = null;
                        const disconnectedText = getTranslation('disconnected-inference', 'è¿æ¥å·²æ–­å¼€');
                        this.updateConnectionStatus('disconnected', disconnectedText);
                        this.scheduleReconnect();
                    };

                    this.ws.onerror = (error) => {
                        console.error('WebSocket é”™è¯¯:', error);
                        this.isConnecting = false;
                        const errorText = getTranslation('connection-error-inference', 'è¿æ¥é”™è¯¯');
                        this.updateConnectionStatus('disconnected', errorText);
                    };

                } catch (error) {
                    console.error('è¿æ¥å¤±è´¥:', error);
                    this.isConnecting = false;
                    const errorText = getTranslation('connection-error-inference', 'è¿æ¥å¤±è´¥');
                    this.updateConnectionStatus('disconnected', errorText);
                    this.scheduleReconnect();
                }
            }

            handleMessage(data) {
                console.log('æ”¶åˆ°æ¶ˆæ¯:', data);
                
                // å¤„ç† Socket.IO æ¶ˆæ¯æ ¼å¼
                if (data.startsWith('42')) {
                    try {
                        // è§£æ Socket.IO æ•°æ®åŒ…
                        const jsonData = data.substring(2);
                        const parsed = JSON.parse(jsonData);
                        
                        if (parsed[0] === 'tegrastats_update' && parsed[1]) {
                            this.dataPacketCount++;
                            this.updateSystemData(parsed[1]);
                        }
                    } catch (error) {
                        console.error('è§£ææ¶ˆæ¯å¤±è´¥:', error);
                    }
                } else if (data === '40') {
                    // Socket.IO æ¡æ‰‹ç¡®è®¤
                    console.log('Socket.IO æ¡æ‰‹å®Œæˆ');
                } else if (data.startsWith('2')) {
                    // Ping frame - å›å¤ pong
                    this.ws.send('3');
                }
            }

            updateSystemData(data) {
                console.log('æ›´æ–°ç³»ç»Ÿæ•°æ®:', data);
                
                // æ›´æ–° CPU æ•°æ®
                this.updateCPUDisplay(data.cpu);
                
                // æ›´æ–°å†…å­˜æ•°æ®
                this.updateMemoryDisplay(data.memory);
                
                // æ›´æ–°æ¸©åº¦æ•°æ®
                this.updateTemperatureDisplay(data.temperature);
                
                // æ›´æ–°åŠŸè€—æ•°æ®
                this.updatePowerDisplay(data.power);
                
                // æ›´æ–° GPU æ•°æ®
                this.updateGPUDisplay(data.gpu);
                
                // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('zh-CN');
                document.getElementById('dataPackets').textContent = this.dataPacketCount;
            }

            updateCPUDisplay(cpuData) {
                if (!cpuData || !cpuData.cores) return;
                
                const content = document.getElementById('cpuContent');
                let html = '<div class="cpu-chart">';
                
                // ç¡®ä¿æœ‰12ä¸ªæ ¸å¿ƒï¼Œå¦‚æœæ•°æ®ä¸è¶³åˆ™è¡¥å……ç©ºæ•°æ®
                const cores = [];
                for (let i = 0; i < 12; i++) {
                    const coreData = cpuData.cores.find(core => core.id === i);
                    cores.push(coreData || { id: i, usage: 0, freq: 0 });
                }
                
                cores.forEach(core => {
                    const usage = parseFloat(core.usage) || 0;
                    const coreLabel = getTranslation('core', 'æ ¸å¿ƒ');
                    
                    // ç¡®ä¿è¿›åº¦æ¡æœ‰è¶³å¤Ÿå®½åº¦æ˜¾ç¤ºæ–‡å­—ï¼Œå‡å°æœ€å°å®½åº¦
                    const barWidth = Math.max(usage, 15); // å‡å°åˆ°15%æœ€å°å®½åº¦
                    
                    html += `
                        <div class="cpu-bar-item">
                            <div class="cpu-bar-label">${coreLabel} ${core.id + 1}</div>
                            <div class="cpu-bar-container">
                                <div class="cpu-bar-fill" style="width: ${barWidth}%; min-width: 28px;">
                                    <div class="cpu-bar-value">${usage.toFixed(1)}%</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                content.innerHTML = html;
            }

            updateMemoryDisplay(memoryData) {
                if (!memoryData) return;
                
                const content = document.getElementById('memoryContent');
                let html = '<div class="memory-chart">';
                
                if (memoryData.ram) {
                    const ramUsagePercent = ((memoryData.ram.used / memoryData.ram.total) * 100).toFixed(1);
                    html += `
                        <div class="memory-item">
                            <div class="memory-metric">
                                <span class="memory-metric-label">RAM</span>
                                <span class="memory-metric-value">${memoryData.ram.used}/${memoryData.ram.total} MB</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${ramUsagePercent}%">${ramUsagePercent}%</div>
                            </div>
                        </div>
                    `;
                }
                
                if (memoryData.swap) {
                    const swapUsagePercent = memoryData.swap.total > 0 ? 
                        ((memoryData.swap.used / memoryData.swap.total) * 100).toFixed(1) : 0;
                    html += `
                        <div class="memory-item">
                            <div class="memory-metric">
                                <span class="memory-metric-label">SWAP</span>
                                <span class="memory-metric-value">${memoryData.swap.used}/${memoryData.swap.total} MB</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${swapUsagePercent}%; min-width: 45px;">${swapUsagePercent}%</div>
                            </div>
                        </div>
                    `;
                }
                
                html += '</div>';
                content.innerHTML = html;
            }

            updateTemperatureDisplay(tempData) {
                if (!tempData) return;
                
                const content = document.getElementById('temperatureContent');
                let html = '<div class="temp-chart">';
                
                const tempItems = [
                    { label: 'CPU', value: tempData.cpu },
                    { label: 'SoC 0', value: tempData.soc0 },
                    { label: 'SoC 1', value: tempData.soc1 },
                    { label: 'SoC 2', value: tempData.soc2 },
                    { label: 'Junction', value: tempData.tj }
                ];
                
                tempItems.forEach(item => {
                    if (item.value !== undefined) {
                        const temp = parseFloat(item.value) || 0;
                        // æ¸©åº¦èŒƒå›´ä¸º0-100Â°C
                        const minTemp = 0;
                        const maxTemp = 100;
                        const tempPercent = Math.max(0, Math.min((temp / maxTemp) * 100, 100));
                        
                        // è®¡ç®—é¢œè‰²æ¸å˜ï¼š40Â°Cä»¥ä¸‹ç»¿è‰²ï¼Œ40Â°C-100Â°Cä»ç»¿è‰²æ¸å˜åˆ°çº¢è‰²
                        let backgroundColor;
                        if (temp <= 40) {
                            backgroundColor = 'linear-gradient(90deg, #4CAF50, #45a049)';
                        } else {
                            // 40Â°Cä»¥ä¸Šçš„æ¸©åº¦æ¸å˜ï¼šä»ç»¿è‰²åˆ°çº¢è‰²
                            const gradientPercent = Math.min((temp - 40) / (100 - 40), 1);
                            const red = Math.round(76 + (244 - 76) * gradientPercent);   // ä»#4CAF50çš„76åˆ°#f44336çš„244
                            const green = Math.round(175 + (67 - 175) * gradientPercent); // ä»#4CAF50çš„175åˆ°#f44336çš„67
                            const blue = Math.round(80 + (54 - 80) * gradientPercent);   // ä»#4CAF50çš„80åˆ°#f44336çš„54
                            
                            const red2 = Math.round(69 + (211 - 69) * gradientPercent);  // ä»#45a049çš„69åˆ°#d32f2fçš„211
                            const green2 = Math.round(160 + (47 - 160) * gradientPercent); // ä»#45a049çš„160åˆ°#d32f2fçš„47
                            const blue2 = Math.round(73 + (47 - 73) * gradientPercent);  // ä»#45a049çš„73åˆ°#d32f2fçš„47
                            
                            backgroundColor = `linear-gradient(90deg, rgb(${red}, ${green}, ${blue}), rgb(${red2}, ${green2}, ${blue2}))`;
                        }
                        
                        html += `
                            <div class="temp-bar-item">
                                <div class="temp-bar-label">${item.label}</div>
                                <div class="temp-bar-container">
                                    <div class="temp-bar-fill" style="width: ${tempPercent}%; background: ${backgroundColor};">
                                        <div class="temp-bar-value">${temp.toFixed(1)}Â°C</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                html += '</div>';
                content.innerHTML = html;
            }

            updatePowerDisplay(powerData) {
                if (!powerData) return;
                
                const content = document.getElementById('powerContent');
                let html = '<div class="memory-chart">';
                
                const powerItems = [
                    { label: 'GPU+SoC', data: powerData.gpu_soc },
                    { label: 'CPU', data: powerData.cpu_cv },
                    { label: getTranslation('system-5v', 'ç³»ç»Ÿ 5V'), data: powerData.sys_5v },
                    { label: 'RAM', data: powerData.ram }
                ];
                
                powerItems.forEach(item => {
                    if (item.data && item.data.current !== undefined) {
                        html += `
                            <div class="memory-item">
                                <div class="memory-metric">
                                    <span class="memory-metric-label">${item.label}</span>
                                    <span class="memory-metric-value">${item.data.current} ${item.data.unit || 'mW'}</span>
                                </div>
                            </div>
                        `;
                    }
                });
                
                html += '</div>';
                content.innerHTML = html;
            }

            updateGPUDisplay(gpuData) {
                if (!gpuData) return;
                
                const content = document.getElementById('gpuContent');
                let html = '<div class="memory-chart">';
                
                if (gpuData.gr3d_freq !== undefined) {
                    const gpuFreqLabel = getTranslation('gpu-freq', '3D GPU é¢‘ç‡');
                    html += `
                        <div class="memory-item">
                            <div class="memory-metric">
                                <span class="memory-metric-label">${gpuFreqLabel}</span>
                                <span class="memory-metric-value">${gpuData.gr3d_freq}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${gpuData.gr3d_freq}%; min-width: 45px;">${gpuData.gr3d_freq}%</div>
                            </div>
                        </div>
                    `;
                }
                
                html += '</div>';
                const noDataText = getTranslation('no-gpu-data', 'æš‚æ—  GPU æ•°æ®');
                content.innerHTML = html || `<div class="memory-chart"><div class="no-data">${noDataText}</div></div>`;
            }

            updateConnectionStatus(status, message) {
                const indicator = document.getElementById('agxStatusIndicator');
                const statusText = document.getElementById('agxStatusText');
                
                indicator.className = `status-indicator status-${status}`;
                statusText.textContent = message;
                
                // ä¿å­˜å½“å‰çŠ¶æ€ç”¨äºè¯­è¨€åˆ‡æ¢æ—¶åˆ·æ–°
                this.currentStatus = status;
            }

            // åˆ·æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤ºï¼ˆç”¨äºè¯­è¨€åˆ‡æ¢ï¼‰
            refreshConnectionStatus() {
                if (this.currentStatus) {
                    let messageKey = '';
                    let fallbackMessage = '';
                    
                    switch(this.currentStatus) {
                        case 'connecting':
                            messageKey = 'connecting-inference';
                            fallbackMessage = 'æ­£åœ¨è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨...';
                            break;
                        case 'connected':
                            messageKey = 'connected-inference';
                            fallbackMessage = 'å·²è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨';
                            break;
                        case 'disconnected':
                            messageKey = 'disconnected-inference';
                            fallbackMessage = 'æ¨ç†æœåŠ¡å™¨ è¿æ¥å·²æ–­å¼€';
                            break;
                    }
                    
                    if (messageKey) {
                        const message = getTranslation(messageKey, fallbackMessage);
                        document.getElementById('agxStatusText').textContent = message;
                    }
                }
            }

            scheduleReconnect() {
                this.reconnectAttempts++;
                const delay = this.reconnectInterval;
                
                setTimeout(() => {
                    this.connect();
                }, delay);
            }

            startConnectionTimeUpdate() {
                setInterval(() => {
                    if (this.connectionStartTime) {
                        const duration = Math.floor((new Date() - this.connectionStartTime) / 1000);
                        const minutes = Math.floor(duration / 60);
                        const seconds = duration % 60;
                        document.getElementById('connectionTime').textContent = 
                            `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    } else {
                        document.getElementById('connectionTime').textContent = '-';
                    }
                }, 1000);
            }
        }

        // åº”ç”¨æœåŠ¡å™¨ ç›‘æ§ç±»
        class åº”ç”¨æœåŠ¡å™¨Monitor {
            constructor() {
                this.ws = null;
                this.reconnectInterval = 3000;
                this.maxReconnectAttempts = 5;
                this.reconnectAttempts = 0;
                this.connectionStartTime = null;
                this.dataPacketCount = 0;
                this.isConnecting = false;
                
                this.init();
            }

            init() {
                this.connect();
                this.startConnectionTimeUpdate();
            }

            connect() {
                if (this.isConnecting) return;
                
                this.isConnecting = true;
                const connectingText = getTranslation('connecting-application', 'æ­£åœ¨è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨...');
                this.updateConnectionStatus('connecting', connectingText);

                try {
                    // è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨ æœåŠ¡å™¨çš„ WebSocket (Socket.IO)
                    this.ws = new WebSocket('ws://10.10.99.99:59090/socket.io/?EIO=4&transport=websocket');
                    
                    this.ws.onopen = () => {
                        console.log('åº”ç”¨æœåŠ¡å™¨ WebSocket è¿æ¥å·²å»ºç«‹');
                        this.isConnecting = false;
                        this.reconnectAttempts = 0;
                        this.connectionStartTime = new Date();
                        const connectedText = getTranslation('connected-application', 'å·²è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨');
                        this.updateConnectionStatus('connected', connectedText);
                        
                        // å‘é€åˆå§‹è¿æ¥æ¶ˆæ¯ (Socket.IO æ¡æ‰‹)
                        this.ws.send('40');
                    };

                    this.ws.onmessage = (event) => {
                        this.handleMessage(event.data);
                    };

                    this.ws.onclose = (event) => {
                        console.log('åº”ç”¨æœåŠ¡å™¨ WebSocket è¿æ¥å·²å…³é—­:', event.code, event.reason);
                        this.isConnecting = false;
                        this.connectionStartTime = null;
                        const disconnectedText = getTranslation('disconnected-application', 'åº”ç”¨æœåŠ¡å™¨ è¿æ¥å·²æ–­å¼€');
                        this.updateConnectionStatus('disconnected', disconnectedText);
                        this.scheduleReconnect();
                    };

                    this.ws.onerror = (error) => {
                        console.error('åº”ç”¨æœåŠ¡å™¨ WebSocket é”™è¯¯:', error);
                        this.isConnecting = false;
                        const errorText = getTranslation('connection-error-application', 'åº”ç”¨æœåŠ¡å™¨ è¿æ¥é”™è¯¯');
                        this.updateConnectionStatus('disconnected', errorText);
                    };

                } catch (error) {
                    console.error('åº”ç”¨æœåŠ¡å™¨ è¿æ¥å¤±è´¥:', error);
                    this.isConnecting = false;
                    const errorText = getTranslation('connection-error-application', 'åº”ç”¨æœåŠ¡å™¨ è¿æ¥å¤±è´¥');
                    this.updateConnectionStatus('disconnected', errorText);
                    this.scheduleReconnect();
                }
            }

            handleMessage(data) {
                console.log('åº”ç”¨æœåŠ¡å™¨ æ”¶åˆ°æ¶ˆæ¯:', data);
                
                // å¤„ç† Socket.IO æ¶ˆæ¯æ ¼å¼
                if (data.startsWith('42')) {
                    try {
                        // è§£æ Socket.IO æ•°æ®åŒ…
                        const jsonData = data.substring(2);
                        const parsed = JSON.parse(jsonData);
                        
                        if (parsed[0] === 'lpmu_status_update' && parsed[1]) {
                            this.dataPacketCount++;
                            this.updateSystemData(parsed[1]);
                        }
                    } catch (error) {
                        console.error('åº”ç”¨æœåŠ¡å™¨ è§£ææ¶ˆæ¯å¤±è´¥:', error);
                    }
                } else if (data === '40') {
                    // Socket.IO æ¡æ‰‹ç¡®è®¤
                    console.log('åº”ç”¨æœåŠ¡å™¨ Socket.IO æ¡æ‰‹å®Œæˆ');
                } else if (data.startsWith('2')) {
                    // Ping frame - å›å¤ pong
                    this.ws.send('3');
                }
            }

            updateSystemData(data) {
                console.log('æ›´æ–° åº”ç”¨æœåŠ¡å™¨ ç³»ç»Ÿæ•°æ®:', data);
                
                // æ›´æ–° CPU æ•°æ®
                this.updateCPUDisplay(data.cpu);
                
                // æ›´æ–°å†…å­˜æ•°æ®
                this.updateMemoryDisplay(data.memory);
                
                // æ›´æ–°æ¸©åº¦æ•°æ®
                this.updateTemperatureDisplay(data.temperature);
                
                // æ›´æ–°ç£ç›˜æ•°æ®
                this.updateDiskDisplay(data.disk);
                
                // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
                document.getElementById('lpmuLastUpdate').textContent = new Date().toLocaleTimeString('zh-CN');
                document.getElementById('lpmuDataPackets').textContent = this.dataPacketCount;
            }

            updateCPUDisplay(cpuData) {
                if (!cpuData || !cpuData.cores) return;
                
                const content = document.getElementById('lpmuCpuContent');
                let html = '<div class="cpu-chart">';
                
                // ç¡®ä¿æœ‰8ä¸ªæ ¸å¿ƒï¼Œå¦‚æœæ•°æ®ä¸è¶³åˆ™è¡¥å……ç©ºæ•°æ®
                const cores = [];
                for (let i = 0; i < 8; i++) {
                    const coreData = cpuData.cores.find(core => core.id === i);
                    cores.push(coreData || { id: i, usage: 0, freq: 0 });
                }
                
                cores.forEach(core => {
                    const usage = parseFloat(core.usage) || 0;
                    const coreLabel = getTranslation('core', 'æ ¸å¿ƒ');
                    
                    // ç¡®ä¿è¿›åº¦æ¡æœ‰è¶³å¤Ÿå®½åº¦æ˜¾ç¤ºæ–‡å­—ï¼Œå‡å°æœ€å°å®½åº¦
                    const barWidth = Math.max(usage, 15); // å‡å°åˆ°15%æœ€å°å®½åº¦
                    
                    html += `
                        <div class="cpu-bar-item">
                            <div class="cpu-bar-label">${coreLabel} ${core.id + 1}</div>
                            <div class="cpu-bar-container">
                                <div class="cpu-bar-fill" style="width: ${barWidth}%; min-width: 28px;">
                                    <div class="cpu-bar-value">${usage.toFixed(1)}%</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                content.innerHTML = html;
            }

            updateMemoryDisplay(memoryData) {
                if (!memoryData) return;
                
                const content = document.getElementById('lpmuMemoryContent');
                let html = '<div class="memory-chart">';
                
                if (memoryData.ram) {
                    html += `
                        <div class="memory-item">
                            <div class="memory-metric">
                                <span class="memory-metric-label">RAM</span>
                                <span class="memory-metric-value">${memoryData.ram.used}/${memoryData.ram.total} ${memoryData.ram.unit}</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${memoryData.ram.percent}%">${memoryData.ram.percent.toFixed(1)}%</div>
                            </div>
                        </div>
                    `;
                }
                
                if (memoryData.swap) {
                    html += `
                        <div class="memory-item">
                            <div class="memory-metric">
                                <span class="memory-metric-label">SWAP</span>
                                <span class="memory-metric-value">${memoryData.swap.used}/${memoryData.swap.total} ${memoryData.swap.unit}</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${memoryData.swap.percent}%; min-width: 45px;">${memoryData.swap.percent.toFixed(1)}%</div>
                            </div>
                        </div>
                    `;
                }
                
                html += '</div>';
                const noDataText = getTranslation('no-memory-data', 'æš‚æ— å†…å­˜æ•°æ®');
                content.innerHTML = html || `<div class="memory-chart"><div class="no-data">${noDataText}</div></div>`;
            }

            updateTemperatureDisplay(tempData) {
                if (!tempData) return;
                
                const content = document.getElementById('lpmuTemperatureContent');
                let html = '<div class="lpmu-temperature-grid">';
                
                // éå†æ‰€æœ‰æ¸©åº¦ä¼ æ„Ÿå™¨
                Object.keys(tempData).forEach(key => {
                    const temp = tempData[key];
                    if (typeof temp === 'number') {
                        // æ¸©åº¦èŒƒå›´ä¸º0-100Â°C
                        const tempPercent = Math.max(0, Math.min((temp / 100) * 100, 100));
                        
                        // è®¡ç®—é¢œè‰²æ¸å˜ï¼š40Â°Cä»¥ä¸‹ç»¿è‰²ï¼Œ40Â°C-100Â°Cä»ç»¿è‰²æ¸å˜åˆ°çº¢è‰²
                        let backgroundColor;
                        if (temp <= 40) {
                            backgroundColor = 'linear-gradient(90deg, #4CAF50, #45a049)';
                        } else {
                            // 40Â°Cä»¥ä¸Šçš„æ¸©åº¦æ¸å˜ï¼šä»ç»¿è‰²åˆ°çº¢è‰²
                            const gradientPercent = Math.min((temp - 40) / (100 - 40), 1);
                            const red = Math.round(76 + (244 - 76) * gradientPercent);   // ä»#4CAF50çš„76åˆ°#f44336çš„244
                            const green = Math.round(175 + (67 - 175) * gradientPercent); // ä»#4CAF50çš„175åˆ°#f44336çš„67
                            const blue = Math.round(80 + (54 - 80) * gradientPercent);   // ä»#4CAF50çš„80åˆ°#f44336çš„54
                            
                            const red2 = Math.round(69 + (211 - 69) * gradientPercent);  // ä»#45a049çš„69åˆ°#d32f2fçš„211
                            const green2 = Math.round(160 + (47 - 160) * gradientPercent); // ä»#45a049çš„160åˆ°#d32f2fçš„47
                            const blue2 = Math.round(73 + (47 - 73) * gradientPercent);  // ä»#45a049çš„73åˆ°#d32f2fçš„47
                            
                            backgroundColor = `linear-gradient(90deg, rgb(${red}, ${green}, ${blue}), rgb(${red2}, ${green2}, ${blue2}))`;
                        }
                        
                        html += `
                            <div class="temp-item">
                                <div class="temp-label">${key}</div>
                                <div style="width: 100%; height: 20px; background-color: #e0e0e0; border-radius: 10px; overflow: hidden; position: relative; margin-top: 8px;">
                                    <div style="height: 100%; border-radius: 10px; transition: width 0.3s ease, background 0.3s ease; position: relative; min-width: 45px; width: ${tempPercent}%; background: ${backgroundColor};">
                                        <div style="font-size: 0.75rem; font-weight: bold; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); position: absolute; right: 8px; top: 50%; transform: translateY(-50%); z-index: 2;">${temp.toFixed(1)}Â°C</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                html += '</div>';
                content.innerHTML = html;
            }

            updateDiskDisplay(diskData) {
                if (!diskData) return;
                
                const content = document.getElementById('lpmuDiskContent');
                let html = '<div class="disk-grid">';
                
                // éå†æ‰€æœ‰ç£ç›˜
                Object.keys(diskData).forEach(key => {
                    const disk = diskData[key];
                    if (disk && disk.percent !== undefined) {
                        html += `
                            <div class="disk-item">
                                <div class="disk-label">${key}</div>
                                <div class="progress-bar" style="margin: 8px 0;">
                                    <div class="progress-fill" style="width: ${disk.percent}%; position: relative; min-width: 45px;">
                                        <span style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: white; font-size: 12px; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); z-index: 2;">${disk.percent.toFixed(1)}%</span>
                                    </div>
                                </div>
                                <div class="disk-details">${disk.used}/${disk.total} ${disk.unit}</div>
                                <div class="disk-details">${disk.mountpoint || ''}</div>
                            </div>
                        `;
                    }
                });
                
                html += '</div>';
                content.innerHTML = html;
            }

            updateConnectionStatus(status, message) {
                const indicator = document.getElementById('lpmuStatusIndicator');
                const statusText = document.getElementById('lpmuStatusText');
                
                indicator.className = `status-indicator status-${status}`;
                statusText.textContent = message;
                
                // ä¿å­˜å½“å‰çŠ¶æ€ç”¨äºè¯­è¨€åˆ‡æ¢æ—¶åˆ·æ–°
                this.currentStatus = status;
            }

            // åˆ·æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤ºï¼ˆç”¨äºè¯­è¨€åˆ‡æ¢ï¼‰
            refreshConnectionStatus() {
                if (this.currentStatus) {
                    let messageKey = '';
                    let fallbackMessage = '';
                    
                    switch(this.currentStatus) {
                        case 'connecting':
                            messageKey = 'connecting-application';
                            fallbackMessage = 'æ­£åœ¨è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨...';
                            break;
                        case 'connected':
                            messageKey = 'connected-application';
                            fallbackMessage = 'å·²è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨';
                            break;
                        case 'disconnected':
                            messageKey = 'disconnected-application';
                            fallbackMessage = 'åº”ç”¨æœåŠ¡å™¨ è¿æ¥å·²æ–­å¼€';
                            break;
                    }
                    
                    if (messageKey) {
                        const message = getTranslation(messageKey, fallbackMessage);
                        document.getElementById('lpmuStatusText').textContent = message;
                    }
                }
            }

            scheduleReconnect() {
                this.reconnectAttempts++;
                const delay = this.reconnectInterval;
                
                setTimeout(() => {
                    this.connect();
                }, delay);
            }

            startConnectionTimeUpdate() {
                setInterval(() => {
                    if (this.connectionStartTime) {
                        const duration = Math.floor((new Date() - this.connectionStartTime) / 1000);
                        const minutes = Math.floor(duration / 60);
                        const seconds = duration % 60;
                        document.getElementById('lpmuConnectionTime').textContent = 
                            `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    } else {
                        document.getElementById('lpmuConnectionTime').textContent = '-';
                    }
                }, 1000);
            }
        }

        // æŠ˜å åŠŸèƒ½
        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId);
            const icon = document.getElementById(sectionId + '-icon');
            
            if (content && icon) {
                content.classList.toggle('collapsed');
                icon.classList.toggle('collapsed');
                
                // ä¿å­˜æŠ˜å çŠ¶æ€
                const isCollapsed = content.classList.contains('collapsed');
                localStorage.setItem(sectionId + '-collapsed', isCollapsed);
            }
        }

        // æ¢å¤æŠ˜å çŠ¶æ€
        function restoreCollapseStates() {
            const sections = ['inference-section', 'application-section', 'model-section'];
            sections.forEach(sectionId => {
                const isCollapsed = localStorage.getItem(sectionId + '-collapsed') === 'true';
                if (isCollapsed) {
                    const content = document.getElementById(sectionId);
                    const icon = document.getElementById(sectionId + '-icon');
                    if (content && icon) {
                        content.classList.add('collapsed');
                        icon.classList.add('collapsed');
                    }
                }
            });
        }

        // åˆ‡æ¢æ¨¡å‹æ—¥å¿—çª—å£
        function toggleModelLog(modelType) {
            const logWindow = document.getElementById(modelType + '-log-window');
            const icon = document.getElementById(modelType + '-log-icon');
            
            if (logWindow && icon) {
                logWindow.classList.toggle('expanded');
                icon.classList.toggle('collapsed');
                
                // å¦‚æœå±•å¼€ï¼Œç«‹å³è·å–æ—¥å¿—å¹¶æ»šåŠ¨åˆ°åº•éƒ¨
                if (logWindow.classList.contains('expanded')) {
                    // æ£€æŸ¥æ¨¡å‹æ˜¯å¦å·²å¯ç”¨
                    const modelData = modelDataCache[modelType];
                    if (modelData && modelData.is_enabled) {
                        fetchModelLogs(modelType);
                    }
                    
                    setTimeout(() => {
                        logWindow.scrollTop = logWindow.scrollHeight;
                    }, 300);
                }
            }
        }

        // æ¨¡å‹çŠ¶æ€ç›‘æ§
        let modelStatusCheckInterval = null;
        let modelDataCache = {};

        function startModelStatusMonitoring() {
            // ç«‹å³æ£€æŸ¥ä¸€æ¬¡
            checkModelStatus();
            
            // æ¯2ç§’æ£€æŸ¥ä¸€æ¬¡
            modelStatusCheckInterval = setInterval(checkModelStatus, 2000);
        }

        function stopModelStatusMonitoring() {
            if (modelStatusCheckInterval) {
                clearInterval(modelStatusCheckInterval);
                modelStatusCheckInterval = null;
            }
        }

        async function checkModelStatus() {
            try {
                // ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œè‡ªåŠ¨é€‚é…å½“å‰è®¿é—®çš„æœåŠ¡å™¨åœ°å€
                const response = await fetch('/api/model_status');
                if (response.ok) {
                    const data = await response.json();
                    if (data.is_valid) {
                        updateModelStatus(data);
                    } else {
                        // æ•°æ®æ— æ•ˆæ—¶æ˜¾ç¤ºé»˜è®¤çŠ¶æ€
                        console.debug('æ¨¡å‹çŠ¶æ€æ•°æ®æ— æ•ˆ');
                    }
                }
            } catch (error) {
                console.error('è·å–æ¨¡å‹çŠ¶æ€å¤±è´¥:', error);
            }
        }

        function updateModelStatus(data) {
            // æ›´æ–°ä¸‰ä¸ªæ¨¡å‹çš„çŠ¶æ€
            updateModelProgress('llm', data.llm);
            updateModelProgress('embedding', data.embedding);
            updateModelProgress('reranker', data.reranker);
            
            // ç¼“å­˜æ•°æ®ç”¨äºæ—¥å¿—æ˜¾ç¤º
            modelDataCache = data;
        }

        function updateModelProgress(modelType, modelData) {
            const progressBar = document.getElementById(modelType + '-progress');
            const statusText = document.getElementById(modelType + '-status-text');
            const progressContainer = progressBar?.parentElement;
            
            if (!progressBar || !statusText) return;
            
            // å¦‚æœæ²¡æœ‰æœ‰æ•ˆæ•°æ®ï¼Œä¿æŒåˆå§‹çŠ¶æ€
            if (!modelData) {
                progressBar.style.width = '100%';  // ä½¿ç”¨æ»¡å®½ä»¥æ˜¾ç¤ºæ–‡å­—
                statusText.textContent = '--';
                progressBar.classList.remove('loading');
                progressBar.style.background = 'linear-gradient(90deg, #E0E0E0, #BDBDBD)';
                statusText.style.color = '#666';
                return;
            }
            
            // è®¡ç®—æ˜¾ç¤ºè¿›åº¦
            const actualProgress = modelData.progress || 0;
            // ç¡®ä¿è¿›åº¦æ¡è‡³å°‘æœ‰ä¸€å®šå®½åº¦ä»¥æ˜¾ç¤ºæ–‡å­—
            const displayProgress = actualProgress > 0 ? Math.max(actualProgress, 20) : 100;
            progressBar.style.width = displayProgress + '%';
            
            // æ›´æ–°çŠ¶æ€æ–‡æœ¬
            statusText.textContent = modelData.status_text || '--';
            
            // æ ¹æ®çŠ¶æ€å†³å®šæ˜¯å¦æ˜¾ç¤ºåŠ è½½åŠ¨ç”»å’Œé¢œè‰²
            const isLoading = actualProgress > 0 && actualProgress < 100 && modelData.is_enabled;
            
            if (isLoading) {
                // æ­£åœ¨åŠ è½½ - ä½¿ç”¨ CSS åŠ¨ç”»ï¼Œæ¸…é™¤ inline background è®© CSS ç±»ç”Ÿæ•ˆ
                progressBar.classList.add('loading');
                progressBar.style.background = '';  // æ¸…é™¤ inline styleï¼Œè®© CSS .loading ç±»ç”Ÿæ•ˆ
                statusText.style.color = 'white';
            } else {
                progressBar.classList.remove('loading');
                
                // è®¾ç½®è¿›åº¦æ¡é¢œè‰²å’Œæ–‡å­—é¢œè‰²
                if (!modelData.is_enabled) {
                    // æœªå¯ç”¨ - ç°è‰²èƒŒæ™¯
                    progressBar.style.background = 'linear-gradient(90deg, #E0E0E0, #BDBDBD)';
                    statusText.style.color = '#666';
                } else if (modelData.startup_complete) {
                    // å¯åŠ¨å®Œæˆ - ç»¿è‰²
                    progressBar.style.background = 'linear-gradient(90deg, #4CAF50, #45a049)';
                    statusText.style.color = 'white';
                } else if (actualProgress === 0) {
                    // ç­‰å¾…ä¸­ - æµ…ç°è‰²
                    progressBar.style.background = 'linear-gradient(90deg, #E0E0E0, #BDBDBD)';
                    statusText.style.color = '#666';
                } else {
                    // å…¶ä»–çŠ¶æ€ - é»˜è®¤ç°è‰²
                    progressBar.style.background = 'linear-gradient(90deg, #BDBDBD, #9E9E9E)';
                    statusText.style.color = 'white';
                }
            }
        }

        // æ¨¡å‹ç±»å‹åˆ°ç¿»è¯‘é”®çš„æ˜ å°„
        const modelTypeToTranslationKey = {
            'llm': 'main-model',
            'embedding': 'embedding-model',
            'reranker': 'reranker-model'
        };
        
        // æ¨ç†æœåŠ¡å™¨åœ°å€ï¼ˆç”¨äºè·å–æ—¥å¿—ï¼‰
        const INFERENCE_SERVER_URL = 'http://10.10.99.98:58090';
        
        // æ—¥å¿—è·å–çŠ¶æ€
        const logFetchState = {
            llm: { lastFetch: 0, enabled: false },
            embedding: { lastFetch: 0, enabled: false },
            reranker: { lastFetch: 0, enabled: false }
        };
        
        // æ›´æ–°æ—¥å¿—çª—å£æ˜¾ç¤º
        function updateModelLogs() {
            const models = ['llm', 'embedding', 'reranker'];
            models.forEach(modelType => {
                const logWindow = document.getElementById(modelType + '-log-window');
                if (!logWindow) return;
                
                const modelData = modelDataCache[modelType];
                
                // è·å–æ­£ç¡®çš„ç¿»è¯‘é”®
                const translationKey = modelTypeToTranslationKey[modelType] || modelType;
                const modelName = getTranslation(translationKey, modelType);
                
                // å¦‚æœæ•°æ®è¿˜æœªåŠ è½½ï¼Œæ˜¾ç¤ºç­‰å¾…çŠ¶æ€
                if (!modelData) {
                    if (logWindow.innerHTML === '') {
                        const waitingText = getTranslation('waiting-for', 'ç­‰å¾…');
                        const statusDataText = getTranslation('status-data', 'çŠ¶æ€æ•°æ®...');
                        logWindow.innerHTML = `<div class="model-log-line"><span class="model-log-timestamp">[--:--:--]</span> ${waitingText} ${modelName} ${statusDataText}</div>`;
                    }
                    return;
                }
                
                // å¦‚æœæœªå¯ç”¨ï¼Œæ˜¾ç¤ºæç¤º
                if (!modelData.is_enabled) {
                    logFetchState[modelType].enabled = false;
                    const translation = getTranslation('model-not-enabled', 'æœªå¯ç”¨');
                    logWindow.innerHTML = `<div class="model-log-line"><span class="model-log-timestamp">[--:--:--]</span> ${translation}${modelName}</div>`;
                } else {
                    // æ¨¡å‹å·²å¯ç”¨ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦è·å–æ—¥å¿—
                    const isExpanded = logWindow.classList.contains('expanded');
                    
                    if (isExpanded && !logFetchState[modelType].enabled) {
                        // åˆšå±•å¼€ï¼Œå¼€å§‹è·å–æ—¥å¿—
                        logFetchState[modelType].enabled = true;
                        fetchModelLogs(modelType);
                    } else if (!isExpanded) {
                        logFetchState[modelType].enabled = false;
                    } else if (isExpanded && logFetchState[modelType].enabled) {
                        // å·²å±•å¼€ä¸”å·²å¯ç”¨ï¼Œå®šæœŸåˆ·æ–°
                        const now = Date.now();
                        if (now - logFetchState[modelType].lastFetch > 5000) {  // æ¯5ç§’åˆ·æ–°
                            fetchModelLogs(modelType);
                        }
                    }
                    
                    // å¦‚æœæ—¥å¿—çª—å£ä¸ºç©ºæˆ–æ˜¾ç¤ºç­‰å¾…çŠ¶æ€ï¼Œæ˜¾ç¤ºåˆå§‹æç¤º
                    if (logWindow.innerHTML === '' || logWindow.innerHTML.includes('æœªå¯ç”¨') || logWindow.innerHTML.includes('ç­‰å¾…') || logWindow.innerHTML.includes('Not Enabled') || logWindow.innerHTML.includes('Waiting')) {
                        const now = new Date();
                        const timestamp = now.toTimeString().split(' ')[0];
                        const clickText = getTranslation('click-to-view-logs', 'ç‚¹å‡»å±•å¼€æŸ¥çœ‹');
                        const logsText = getTranslation('logs', 'æ—¥å¿—...');
                        logWindow.innerHTML = `<div class="model-log-line"><span class="model-log-timestamp">[${timestamp}]</span> ${clickText} ${modelName} ${logsText}</div>`;
                    }
                }
            });
        }
        
        // ä»æ¨ç†æœåŠ¡å™¨è·å–æ—¥å¿—
        async function fetchModelLogs(modelType) {
            const logWindow = document.getElementById(modelType + '-log-window');
            if (!logWindow) return;
            
            try {
                logFetchState[modelType].lastFetch = Date.now();
                const response = await fetch(`${INFERENCE_SERVER_URL}/api/model_logs/${modelType}?lines=100`);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.logs && data.logs.length > 0) {
                        // æ¸²æŸ“æ—¥å¿—
                        const logsHtml = data.logs.map(line => 
                            `<div class="model-log-line">${escapeHtml(line)}</div>`
                        ).join('');
                        logWindow.innerHTML = logsHtml;
                        
                        // æ»šåŠ¨åˆ°åº•éƒ¨
                        logWindow.scrollTop = logWindow.scrollHeight;
                    } else {
                        const translationKey = modelTypeToTranslationKey[modelType];
                        const modelName = getTranslation(translationKey, modelType);
                        const noLogsText = getTranslation('no-logs-output', 'æš‚æ— æ—¥å¿—è¾“å‡º');
                        logWindow.innerHTML = `<div class="model-log-line"><span class="model-log-timestamp">[${new Date().toTimeString().split(' ')[0]}]</span> ${modelName} ${noLogsText}</div>`;
                    }
                }
            } catch (error) {
                console.debug(`è·å– ${modelType} æ—¥å¿—å¤±è´¥:`, error);
                // ä¸è¦†ç›–ç°æœ‰å†…å®¹ï¼Œé™é»˜å¤±è´¥
            }
        }
        
        // HTML è½¬ä¹‰å‡½æ•°
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–ç›‘æ§
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–ç›‘æ§ç±»å¹¶ä¿å­˜ä¸ºå…¨å±€å˜é‡ä»¥ä¾¿è¯­è¨€åˆ‡æ¢æ—¶ä½¿ç”¨
            window.agxMonitor = new æ¨ç†æœåŠ¡å™¨Monitor();
            window.åº”ç”¨æœåŠ¡å™¨Monitor = new åº”ç”¨æœåŠ¡å™¨Monitor();
            
            // æ·»åŠ æ»šåŠ¨ç›‘å¬å™¨æ¥å®ç°æ–‡å­—é¢œè‰²æ¸å˜
            initScrollColorTransition();
            
            // åˆå§‹åŒ–è¯­è¨€ç³»ç»Ÿ
            initLanguageSystem();
            
            // æ¢å¤æŠ˜å çŠ¶æ€
            restoreCollapseStates();
            
            // å¯åŠ¨æ¨¡å‹çŠ¶æ€ç›‘æ§
            startModelStatusMonitoring();
            
            // å®šæœŸæ›´æ–°æ—¥å¿—æ˜¾ç¤º
            setInterval(updateModelLogs, 3000);
        });

        // è¯­è¨€ç¿»è¯‘ç³»ç»Ÿ
        const translations = {
            'zh': {
                'title': 'RM - 01 Dashboard',
                'subtitle': 'RobOS ( Rack on board ) å®æ—¶ç³»ç»Ÿæ€§èƒ½ç›‘æ§é¢æ¿',
                'connecting-inference': 'æ­£åœ¨è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨...',
                'connecting-application': 'æ­£åœ¨è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨...',
                'connected-inference': 'å·²è¿æ¥åˆ° æ¨ç†æœåŠ¡å™¨',
                'connected-application': 'å·²è¿æ¥åˆ° åº”ç”¨æœåŠ¡å™¨',
                'disconnected-inference': 'æ¨ç†æœåŠ¡å™¨ è¿æ¥å·²æ–­å¼€',
                'disconnected-application': 'åº”ç”¨æœåŠ¡å™¨ è¿æ¥å·²æ–­å¼€',
                'connection-error-inference': 'æ¨ç†æœåŠ¡å™¨ è¿æ¥é”™è¯¯',
                'connection-error-application': 'åº”ç”¨æœåŠ¡å™¨ è¿æ¥é”™è¯¯',
                'inference-monitoring': 'æ¨ç†æ¨¡ç»„ç›‘æ§',
                'application-monitoring': 'åº”ç”¨æ¨¡ç»„ç›‘æ§',
                'nvidia-status': 'NVIDIA æ¨ç†æœåŠ¡å™¨ç³»ç»ŸçŠ¶æ€',
                'intel-status': 'Intel X86 åº”ç”¨æœåŠ¡å™¨ç³»ç»ŸçŠ¶æ€',
                'cpu-monitoring': 'CPU ç›‘æ§',
                'memory-monitoring': 'æ˜¾å­˜ç›‘æ§',
                'ram-monitoring': 'å†…å­˜ç›‘æ§',
                'temperature-monitoring': 'æ¸©åº¦ç›‘æ§',
                'power-monitoring': 'åŠŸè€—ç›‘æ§',
                'gpu-monitoring': 'GPU ç›‘æ§',
                'disk-monitoring': 'ç£ç›˜ç›‘æ§',
                'system-info': 'ç³»ç»Ÿä¿¡æ¯',
                'waiting-data': 'ç­‰å¾…æ•°æ®...',
                'last-update': 'æœ€åæ›´æ–°',
                'connection-time': 'è¿æ¥æ—¶é—´',
                'data-packets': 'æ•°æ®åŒ…',
                'core': 'æ ¸å¿ƒ',
                'system-5v': 'ç³»ç»Ÿ 5V',
                'gpu-freq': '3D GPU é¢‘ç‡',
                'no-gpu-data': 'æš‚æ—  GPU æ•°æ®',
                'no-memory-data': 'æš‚æ— å†…å­˜æ•°æ®',
                'model-monitoring': 'æ¨¡å‹çŠ¶æ€ç›‘æ§',
                'model-status-desc': 'æ¨ç†æ¨¡å‹åŠ è½½å’Œè¿è¡ŒçŠ¶æ€',
                'model-loading-status': 'æ¨¡å‹æ‹‰èµ·çŠ¶æ€',
                'model-runtime-logs': 'æ¨¡å‹è¿è¡Œæ—¥å¿—',
                'main-model': 'ä¸»æ¨¡å‹',
                'embedding-model': 'åµŒå…¥æ¨¡å‹',
                'reranker-model': 'é‡æ’æ¨¡å‹',
                'model-not-enabled': 'æœªå¯ç”¨',
                'waiting-for': 'ç­‰å¾…',
                'status-data': 'çŠ¶æ€æ•°æ®...',
                'click-to-view-logs': 'ç‚¹å‡»å±•å¼€æŸ¥çœ‹',
                'logs': 'æ—¥å¿—...',
                'no-logs-output': 'æš‚æ— æ—¥å¿—è¾“å‡º'
            },
            'en': {
                'title': 'RM - 01 Dashboard',
                'subtitle': 'RobOS ( Rack on board ) Real-time System Performance Monitor',
                'connecting-inference': 'Connecting to Inference Server...',
                'connecting-application': 'Connecting to Application Server...',
                'connected-inference': 'Connected to Inference Server',
                'connected-application': 'Connected to Application Server',
                'disconnected-inference': 'Inference Server Disconnected',
                'disconnected-application': 'Application Server Disconnected',
                'connection-error-inference': 'Inference Server Connection Error',
                'connection-error-application': 'Application Server Connection Error',
                'inference-monitoring': 'Inference Module Monitor',
                'application-monitoring': 'Application Module Monitor',
                'nvidia-status': 'NVIDIA Inference Server System Status',
                'intel-status': 'Intel X86 Application Server System Status',
                'cpu-monitoring': 'CPU Monitor',
                'memory-monitoring': 'VRAM Monitor',
                'ram-monitoring': 'Memory Monitor',
                'temperature-monitoring': 'Temperature Monitor',
                'power-monitoring': 'Power Monitor',
                'gpu-monitoring': 'GPU Monitor',
                'disk-monitoring': 'Disk Monitor',
                'system-info': 'System Information',
                'waiting-data': 'Waiting for data...',
                'last-update': 'Last Update',
                'connection-time': 'Connection Time',
                'data-packets': 'Data Packets',
                'core': 'Core',
                'system-5v': 'System 5V',
                'gpu-freq': '3D GPU Frequency',
                'no-gpu-data': 'No GPU Data Available',
                'no-memory-data': 'No Memory Data Available',
                'model-monitoring': 'Model Status Monitor',
                'model-status-desc': 'Model Loading Progress and Runtime Logs',
                'model-loading-status': 'Model Loading Status',
                'model-runtime-logs': 'Model Runtime Logs',
                'main-model': 'Main Model',
                'embedding-model': 'Embedding Model',
                'reranker-model': 'Reranker Model',
                'model-not-enabled': 'Not Enabled',
                'waiting-for': 'Waiting for',
                'status-data': 'status data...',
                'click-to-view-logs': 'Click to expand',
                'logs': 'logs...',
                'no-logs-output': 'No logs available'
            }
        };

        let currentLanguage = 'zh';

        function initLanguageSystem() {
            // ä»æœ¬åœ°å­˜å‚¨è¯»å–è¯­è¨€è®¾ç½®
            const savedLanguage = localStorage.getItem('dashboard-language');
            if (savedLanguage && translations[savedLanguage]) {
                currentLanguage = savedLanguage;
            }
            
            // æ›´æ–°è¯­è¨€åˆ‡æ¢æŒ‰é’®æ˜¾ç¤º
            updateLanguageSwitcher();
            
            // å¦‚æœæ˜¯è‹±æ–‡ï¼Œç«‹å³ç¿»è¯‘
            if (currentLanguage === 'en') {
                translatePage('en');
            }
        }

        function switchLanguage() {
            currentLanguage = currentLanguage === 'zh' ? 'en' : 'zh';
            localStorage.setItem('dashboard-language', currentLanguage);
            updateLanguageSwitcher();
            translatePage(currentLanguage);
        }

        function updateLanguageSwitcher() {
            const langText = document.getElementById('langText');
            if (langText) {
                langText.textContent = currentLanguage === 'zh' ? 'EN' : 'ä¸­æ–‡';
            }
        }

        function translatePage(language) {
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[language] && translations[language][key]) {
                    // ç‰¹æ®Šå¤„ç†è¿æ¥çŠ¶æ€æ–‡æœ¬ï¼Œä¿æŒå½“å‰å®é™…çŠ¶æ€
                    if (key === 'connecting-inference' || key === 'connecting-application' || 
                        key === 'connected-inference' || key === 'connected-application' ||
                        key === 'disconnected-inference' || key === 'disconnected-application' ||
                        key === 'connection-error-inference' || key === 'connection-error-application') {
                        // è·³è¿‡è¿æ¥çŠ¶æ€æ–‡æœ¬çš„ç¿»è¯‘ï¼Œè®©Monitorç±»æ¥ç®¡ç†è¿™äº›çŠ¶æ€
                        return;
                    }
                    element.textContent = translations[language][key];
                }
            });
            
            // åˆ·æ–°å„ä¸ªç›‘æ§å™¨çš„è¿æ¥çŠ¶æ€æ˜¾ç¤º
            if (window.agxMonitor && typeof window.agxMonitor.refreshConnectionStatus === 'function') {
                window.agxMonitor.refreshConnectionStatus();
            }
            if (window.åº”ç”¨æœåŠ¡å™¨Monitor && typeof window.åº”ç”¨æœåŠ¡å™¨Monitor.refreshConnectionStatus === 'function') {
                window.åº”ç”¨æœåŠ¡å™¨Monitor.refreshConnectionStatus();
            }
            
            // æ›´æ–°æ–‡æ¡£æ ‡é¢˜
            if (language === 'en') {
                document.title = 'RM-01 Dashboard - RobOS Monitor';
                document.querySelector('meta[name="apple-mobile-web-app-title"]').content = 'RM - 01 Monitor Panel';
            } else {
                document.title = 'Rob OS';
                document.querySelector('meta[name="apple-mobile-web-app-title"]').content = 'RM - 01 ç›‘æ§é¢æ¿';
            }
            
            // åˆ·æ–°æ¨¡å‹æ—¥å¿—çª—å£çš„åŠ¨æ€æ–‡æœ¬
            if (typeof updateModelLogs === 'function') {
                updateModelLogs();
            }
        }

        function getTranslation(key, fallback = '') {
            if (translations[currentLanguage] && translations[currentLanguage][key]) {
                return translations[currentLanguage][key];
            }
            return fallback || key;
        }

        // æ»šåŠ¨é¢œè‰²æ¸å˜åŠŸèƒ½
        function initScrollColorTransition() {
            const header = document.querySelector('.header');
            const headerH1 = document.querySelector('.header h1');
            const headerP = document.querySelector('.header p');
            const connectionStatus = document.querySelector('.connection-status');
            const connectionTexts = document.querySelectorAll('.connection-status span:not(.status-indicator)');
            const languageSwitcher = document.querySelector('.language-switcher');
            const langText = document.querySelector('.lang-text');
            
            // è®¡ç®—10%æ»šåŠ¨è·ç¦»
            const maxScroll = window.innerHeight * 0.1;
            
            function updateTextColors() {
                // ä½¿ç”¨å¤šç§æ–¹æ³•è·å–æ»šåŠ¨ä½ç½®ï¼Œç¡®ä¿ç§»åŠ¨ç«¯å…¼å®¹æ€§
                const scrollY = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
                
                // è®¡ç®—æ¸å˜è¿›åº¦ (0-1)
                const progress = Math.min(scrollY / maxScroll, 1);
                
                // ä»ç™½è‰²(255,255,255)æ¸å˜åˆ°#323232(50,50,50)
                const startColor = { r: 255, g: 255, b: 255 };
                const endColor = { r: 50, g: 50, b: 50 };
                
                const currentColor = {
                    r: Math.round(startColor.r + (endColor.r - startColor.r) * progress),
                    g: Math.round(startColor.g + (endColor.g - startColor.g) * progress),
                    b: Math.round(startColor.b + (endColor.b - startColor.b) * progress)
                };
                
                const colorValue = `rgb(${currentColor.r}, ${currentColor.g}, ${currentColor.b})`;
                
                // åº”ç”¨é¢œè‰²åˆ°å„ä¸ªå…ƒç´ 
                if (header) header.style.color = colorValue;
                if (headerH1) {
                    headerH1.style.color = colorValue;
                    // è°ƒæ•´æ–‡å­—é˜´å½±é€æ˜åº¦
                    const shadowOpacity = 0.3 * (1 - progress);
                    headerH1.style.textShadow = `2px 2px 4px rgba(0,0,0,${shadowOpacity})`;
                }
                if (headerP) headerP.style.color = colorValue;
                if (connectionStatus) connectionStatus.style.color = colorValue;
                
                // æ›´æ–°è¯­è¨€åˆ‡æ¢æŒ‰é’®é¢œè‰²
                if (languageSwitcher) languageSwitcher.style.color = colorValue;
                if (langText) langText.style.color = colorValue;
                
                // æ›´æ–°è¿æ¥çŠ¶æ€æ–‡å­—é¢œè‰²
                connectionTexts.forEach(text => {
                    if (text) text.style.color = colorValue;
                });
            }
            
            // æ·»åŠ å¤šç§æ»šåŠ¨äº‹ä»¶ç›‘å¬å™¨ï¼Œç¡®ä¿ç§»åŠ¨ç«¯å…¼å®¹æ€§
            const options = { passive: true }; // ä½¿ç”¨ passive æé«˜æ€§èƒ½
            
            // æ ‡å‡†æ»šåŠ¨äº‹ä»¶
            window.addEventListener('scroll', updateTextColors, options);
            
            // iOS Safari ç‰¹æ®Šå¤„ç†
            document.addEventListener('scroll', updateTextColors, options);
            document.addEventListener('touchmove', updateTextColors, options);
            
            // ä½¿ç”¨ requestAnimationFrame ä¼˜åŒ–æ€§èƒ½
            let ticking = false;
            function requestTick() {
                if (!ticking) {
                    requestAnimationFrame(updateTextColors);
                    ticking = true;
                    setTimeout(() => { ticking = false; }, 16); // 60fps é™åˆ¶
                }
            }
            
            // è§¦æ‘¸äº‹ä»¶å¤„ç†ï¼ˆç§»åŠ¨ç«¯ï¼‰
            window.addEventListener('touchstart', requestTick, options);
            window.addEventListener('touchmove', requestTick, options);
            window.addEventListener('touchend', requestTick, options);
            
            // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°è®¡ç®—
            window.addEventListener('resize', () => {
                setTimeout(updateTextColors, 100);
            }, options);
            
            // å¼ºåˆ¶åˆå§‹åŒ–é¢œè‰²ï¼ˆå»¶è¿Ÿæ‰§è¡Œç¡®ä¿DOMå®Œå…¨åŠ è½½ï¼‰
            setTimeout(updateTextColors, 100);
            
            // å®šæœŸæ›´æ–°ä»¥ç¡®ä¿çŠ¶æ€æ­£ç¡®ï¼ˆç§»åŠ¨ç«¯å¤‡ç”¨æ–¹æ¡ˆï¼‰
            setInterval(updateTextColors, 500);
        }
    </script>
</body>
</html>
